# 更新日志

本文件记录了海豹骰子AI聊天机器人插件的所有重要更改。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/spec/v2.0.0.html)。

## [2.0.0] - 2024-12-19

### 重大变更 - ⚠️ 破坏性更新
- 🔄 **API重构**: 从OpenAI API迁移到阿里云DashScope API（通义千问）
- 🔧 **配置变更**: `OPENAI_API_KEY` → `DASHSCOPE_API_KEY`
- 🔧 **模型配置**: `OPENAI_MODEL` → `DASHSCOPE_MODEL`

### 新增
- 🧠 **通义千问支持**: 支持qwen-turbo、qwen-plus、qwen-max等模型
- 📚 **模型选择**: 可根据需求选择不同性能等级的模型
- 🌐 **本土化**: 使用国内API服务，更稳定的网络连接

### 变更
- 📦 **依赖更新**: 替换`openai`为`dashscope`包
- 🔧 **配置系统**: 更新环境变量配置项
- 📖 **文档更新**: 全面更新README和技术文档

### 移除
- ❌ **OpenAI支持**: 不再支持OpenAI官方API
- ❌ **Azure OpenAI**: 不再支持Azure OpenAI服务

### 迁移指南
如果您正在从v1.x版本升级：
1. 修改`.env`文件中的配置项名称
2. 获取DashScope API密钥并配置
3. 选择合适的通义千问模型
4. 更新Python依赖包

## [1.1.0] - 2024-12-19

### 新增功能
- 🆕 **对话列表查询**：新增 `/conversations/{user_id}` API接口，可查看用户的所有对话及消息数量
- 🆕 **增强的健康检查**：`/health` 接口现在返回更详细的状态信息，包括API配置状态
- 🆕 **生产环境部署**：添加 `run_prod.py` 生产环境启动脚本
- 🆕 **PM2进程管理**：新增 PM2 配置文件和部署指南
- 🆕 **完整文档体系**：新增多个详细的配置和部署文档

### 改进功能
- ✨ **前端用户体验**：重新设计的帮助界面，更详细的错误提示和状态反馈
- ✨ **错误处理增强**：更智能的错误分类和用户友好的错误信息
- ✨ **测试功能改进**：`.chat test` 命令现在显示更详细的服务状态信息
- ✨ **日志系统**：改进的日志记录，便于调试和监控
- ✨ **配置管理**：更灵活的环境变量配置，支持更多自定义选项

### 技术改进
- 🔧 **API接口标准化**：统一的请求/响应格式，完整的参数验证
- 🔧 **代码结构优化**：重构了对话历史管理逻辑，提高了性能和可维护性
- 🔧 **文档完善**：更新了技术文档、API文档和部署指南
- 🔧 **依赖管理**：明确了依赖版本，确保环境兼容性

### 移除
- ❌ **重复文件清理**：删除了根目录的重复 `config.py` 文件

### 文档更新
- 📚 更新主 README.md，包含完整的API接口文档
- 📚 重新编写技术文档，包含详细的架构说明
- 📚 添加部署指南和故障排除说明
- 📚 完善了 DashScope 配置说明文档

## [1.0.9] - 2024-12-18

### 改进功能
- ✨ 支持连续对话和上下文记忆
- ✨ 改进了错误处理和用户反馈
- 🔧 添加了测试命令 `.chat test`

### 修复问题
- 🐛 修复了参数解析的稳定性问题
- 🐛 改进了网络连接的错误处理

## [1.0.8] - 2024-12-17

### 改进功能
- ✨ 改进错误处理和日志记录
- 🔧 优化了插件加载逻辑

## [1.0.5] - 2024-12-16

### 初始版本
- 🆕 基础AI对话功能
- 🆕 支持 `.chat <消息>` 命令
- 🆕 集成阿里云DashScope API
- 🆕 基本的对话历史管理

---

## 版本说明

- **主版本号**: 不兼容的API修改
- **次版本号**: 向后兼容的功能性新增
- **修订号**: 向后兼容的问题修正

## 贡献指南

欢迎提交Issue和Pull Request！请确保：
1. 遵循现有的代码风格
2. 添加适当的测试（如果适用）
3. 更新相关文档
4. 在此文件中记录重要更改 